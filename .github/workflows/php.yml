name: PHP Composer

on: [push]

jobs:
    build:

    runs-on: [ubuntu-latest, macos-latest, windows-latest]

    steps:
        - uses: actions/checkout@v1

        - name: Validate composer.json and composer.lock
            run: composer validate

        - name: Install dependencies
            run: composer install --prefer-dist --no-progress --no-suggest

        -   name: Running tests
                run: composer run-script test

        - name: Upload coverage to Codecov
            uses: codecov/codecov-action@v1
            with:
            token: ${{ secrets.826813e7-0cd1-4dfb-9f0f-b5aabc056d0f }}
            file: ./coverage.xml
            flags: unittests
            name: codecov-umbrella
            yml: ./codecov.yml
            fail_ci_if_error: true
